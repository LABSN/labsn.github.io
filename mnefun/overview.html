<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Overview &#8212; mnefun 0.2.0.dev0 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/default.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="python_reference.html" />
    <link rel="prev" title="mnefun" href="index.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js "></script>

<link href="http://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

  </head><body>

  <div id="navbar" class="('navbar',) navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html"><span><img src="_static/ilabs.png"></span>
          mnefun</a>
        <span class="navbar-text navbar-version pull-left"><b>0.2.0.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="#">Overview</a></li>
                <li><a href="python_reference.html">API reference</a></li>
                <li><a href="whats_new.html">What's new</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html"> <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="whats_new.html">What’s new</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="overview">
<span id="id1"></span><h1><a class="toc-backref" href="#id3">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">mnefun</span></code> is designed to streamline ILABS data processing by automating and
standardizing data retrieval, remote machine processing (MaxFilter),
preprocessing steps, and inverse computation.</p>
<p>A critical idea is that, once an experiment is complete, <strong>you or another ILABS
person should be able to run your analysis script once, from scratch, for all
subjects</strong>, and end up with all of the basic preprocessed files (evoked,
epochs, inverse, etc.) you will need for your downstream scripts used for
publication (stats, etc.).</p>
<p>To achieve <code class="docutils literal notranslate"><span class="pre">mnefun</span></code>’s reproducibility goal, <strong>it is important
not to run your processing script by changing parameters for different
subjects as you process each of them, or by doing steps manually</strong>.
Where subject-specific values are needed, we can add functionality to allow
subject-specific values in the script itself, such as <code class="docutils literal notranslate"><span class="pre">proj_nums</span></code>
(see below).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The one step that might (somewhat routinely) need to be “worked around” is
the data fetching step, which requires that the files on the acquisition
machine be named properly, which might not always be the case, for example
when:</p>
<ul class="simple">
<li><p>files are named incorrectly (typos, inconsistently) during acquisition</p></li>
<li><p>runs are re-executed and saved with a different name
(e.g., <code class="docutils literal notranslate"><span class="pre">_redo_raw.fif</span></code>).</p></li>
</ul>
<p>But this should ideally be the exception and not the rule.</p>
</div>
<p>Experiment parameters can be specified using a <code class="docutils literal notranslate"><span class="pre">params</span> <span class="pre">=</span> <span class="pre">Params(...)</span></code> call in
a script (old way), or by specifying a YAML script with the experiment
parameters (new way) and using <a class="reference internal" href="generated/mnefun.read_params.html#mnefun.read_params" title="mnefun.read_params"><code class="xref py py-func docutils literal notranslate"><span class="pre">mnefun.read_params()</span></code></a> to load the
parameters. The processing pipeline steps and relationships are given below.
All YAML parameters are described in their appropriate sections.
Consider looking at <code class="docutils literal notranslate"><span class="pre">mnefun/examples/funloc</span></code> directory for a canonical
example of how to process data using mnefun.</p>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id3">Overview</a></p>
<ul>
<li><p><a class="reference internal" href="#flow-chart" id="id4">Flow chart</a></p></li>
<li><p><a class="reference internal" href="#running-parameters" id="id5">Running parameters</a></p>
<ul>
<li><p><a class="reference internal" href="#general-general-options" id="id6"><code class="docutils literal notranslate"><span class="pre">general</span></code>: General options</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#fetch-raw" id="id7">1. fetch_raw</a></p>
<ul>
<li><p><a class="reference internal" href="#fetch-raw-raw-fetching-parameters" id="id8"><code class="docutils literal notranslate"><span class="pre">fetch_raw</span></code>: Raw fetching parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#do-score" id="id9">2. do_score</a></p>
<ul>
<li><p><a class="reference internal" href="#scoring-scoring-parameters" id="id10"><code class="docutils literal notranslate"><span class="pre">scoring</span></code>: Scoring parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#do-sss" id="id11">3. do_sss</a></p>
<ul>
<li><p><a class="reference internal" href="#preprocessing-multithreading-multithreading-parameters" id="id12"><code class="docutils literal notranslate"><span class="pre">preprocessing:</span> <span class="pre">multithreading</span></code>: Multithreading parameters</a></p></li>
<li><p><a class="reference internal" href="#preprocessing-pre-sss-bads-automatic-bad-channel-detection" id="id13"><code class="docutils literal notranslate"><span class="pre">preprocessing:</span> <span class="pre">pre-SSS</span> <span class="pre">bads</span></code>: Automatic bad channel detection</a></p></li>
<li><p><a class="reference internal" href="#preprocessing-head-position-estimation-head-position-estimation-parameters" id="id14"><code class="docutils literal notranslate"><span class="pre">preprocessing:</span> <span class="pre">head_position_estimation</span></code>: Head position estimation parameters</a></p></li>
<li><p><a class="reference internal" href="#preprocessing-annotations-annotation-parameters" id="id15"><code class="docutils literal notranslate"><span class="pre">preprocessing:</span> <span class="pre">annotations</span></code>: Annotation parameters</a></p></li>
<li><p><a class="reference internal" href="#preprocessing-sss-sss-parameters" id="id16"><code class="docutils literal notranslate"><span class="pre">preprocessing:</span> <span class="pre">sss</span></code>: SSS parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#do-ch-fix" id="id17">4. do_ch_fix</a></p></li>
<li><p><a class="reference internal" href="#gen-ssp" id="id18">5. gen_ssp</a></p>
<ul>
<li><p><a class="reference internal" href="#preprocessing-filtering-filtering-parameters" id="id19"><code class="docutils literal notranslate"><span class="pre">preprocessing:</span> <span class="pre">filtering</span></code>: Filtering parameters</a></p></li>
<li><p><a class="reference internal" href="#preprocessing-post-sss-bads-marking-bad-channels-during-ssp" id="id20"><code class="docutils literal notranslate"><span class="pre">preprocessing:</span> <span class="pre">post-SSS</span> <span class="pre">bads</span></code>: Marking bad channels during SSP</a></p></li>
<li><p><a class="reference internal" href="#preprocessing-ssp-ssp-creation-parameters" id="id21"><code class="docutils literal notranslate"><span class="pre">preprocessing:</span> <span class="pre">ssp</span></code>: SSP creation parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#apply-ssp" id="id22">6. apply_ssp</a></p></li>
<li><p><a class="reference internal" href="#write-epochs" id="id23">7. write_epochs</a></p>
<ul>
<li><p><a class="reference internal" href="#epoching-epoching-parameters" id="id24"><code class="docutils literal notranslate"><span class="pre">epoching</span></code>: Epoching parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#gen-covs" id="id25">8. gen_covs</a></p>
<ul>
<li><p><a class="reference internal" href="#covariance-covariance-parameters" id="id26"><code class="docutils literal notranslate"><span class="pre">covariance</span></code>: Covariance parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#gen-fwd" id="id27">9. gen_fwd</a></p>
<ul>
<li><p><a class="reference internal" href="#forward-forward-parameters" id="id28"><code class="docutils literal notranslate"><span class="pre">forward</span></code>: Forward parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#gen-inv" id="id29">10. gen_inv</a></p>
<ul>
<li><p><a class="reference internal" href="#inverse-inverse-parameters" id="id30"><code class="docutils literal notranslate"><span class="pre">inverse</span></code>: Inverse parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#gen-report" id="id31">11. gen_report</a></p>
<ul>
<li><p><a class="reference internal" href="#report-params-report-parameters" id="id32"><code class="docutils literal notranslate"><span class="pre">report_params</span></code>: Report parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#filename-standardization" id="id33">Filename standardization</a></p>
<ul>
<li><p><a class="reference internal" href="#naming-file-naming-tags-and-folders" id="id34"><code class="docutils literal notranslate"><span class="pre">naming</span></code>: File naming tags and folders</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#preparing-your-machine-for-maxfilter-use" id="id35">Preparing your machine for MaxFilter use</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="flow-chart">
<h2><a class="toc-backref" href="#id4">Flow chart</a><a class="headerlink" href="#flow-chart" title="Permalink to this headline">¶</a></h2>
<div class="graphviz"><object data="_images/graphviz-c4e731a5801112ccf8d7bd790f8bcb2071eda445.svg" type="image/svg+xml" class="graphviz">
<p class="warning">strict digraph &quot;mnefun flow diagram&quot; {
	graph [bb=&quot;0,0,577.5,869&quot;,
		bgcolor=&quot;#00000000&quot;,
		nodesep=0.2,
		ranksep=0.1
	];
	node [fontname=&quot;sans-serif&quot;,
		fontsize=8,
		label=&quot;\N&quot;,
		margin=&quot;0.1,0.05&quot;,
		shape=box
	];
	edge [fontname=&quot;sans-serif&quot;,
		fontsize=8
	];
	{
		graph [rank=same];
		htm		 [fillcolor=&quot;#66CCEE&quot;,
			fontcolor=&quot;#000000&quot;,
			height=0.5,
			label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;subj_fil*_report.html&lt;/FONT&gt;&gt;,
			pos=&quot;252.5,44&quot;,
			style=filled,
			width=1.5833];
		legend		 [height=1.2222,
			label=&lt;&lt;TABLE BORDER=&quot;0&quot; CELLBORDER=&quot;0&quot; CELLSPACING=&quot;4&quot; CELLPADDING=&quot;4&quot;&gt;&lt;TR&gt;&lt;TD BGCOLOR=&quot;#CCBB44&quot;&gt;    &lt;/TD&gt;&lt;TD ALIGN=&quot;left&quot;&gt;Remote: acquisiton machine&lt;/TD&gt;&lt;/TR&gt;&lt;TR&gt;&lt;TD BGCOLOR=&quot;#EE6677&quot;&gt;    &lt;/TD&gt;&lt;TD ALIGN=&quot;left&quot;&gt;Local: obligatory user-created files&lt;/TD&gt;&lt;/TR&gt;&lt;TR&gt;&lt;TD BGCOLOR=&quot;#FFD8DF&quot;&gt;    &lt;/TD&gt;&lt;TD ALIGN=&quot;left&quot;&gt;Local: optional user-created files&lt;/TD&gt;&lt;/TR&gt;&lt;TR&gt;&lt;TD BGCOLOR=&quot;#66CCEE&quot;&gt;    &lt;/TD&gt;&lt;TD ALIGN=&quot;left&quot;&gt;Local: pipeline-created files&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;&gt;,
			margin=0,
			pos=&quot;418.5,44&quot;,
			shape=plaintext,
			width=2.625];
	}
	sco	 [fillcolor=&quot;#EE6677&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;score.py&lt;/FONT&gt;&gt;,
		pos=&quot;76.5,691&quot;,
		style=filled,
		width=0.77778];
	lst	 [fillcolor=&quot;#66CCEE&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/lists/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;ALL_*-eve.lst&lt;/FONT&gt;&gt;,
		pos=&quot;39.5,603&quot;,
		style=filled,
		width=1.0972];
	sco -&gt; lst	 [URL=&quot;../overview.html#do-score&quot;,
		fontsize=10,
		label=&lt;&lt;B&gt;2. do_score&lt;/B&gt;&gt;,
		labeltooltip=&quot;2. do_score&quot;,
		lp=&quot;78.5,647&quot;,
		pos=&quot;e,38.161,621.11 52.039,672.88 49.892,670.44 47.977,667.81 46.5,665 41.108,654.76 38.998,642.26 38.369,631.18&quot;,
		target=_top];
	evo	 [fillcolor=&quot;#66CCEE&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/inverse/, ./SUBJ/epochs/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*-evo.fif, *-epo.fif&lt;/FONT&gt;&gt;,
		pos=&quot;139.5,186&quot;,
		style=filled,
		width=2.0139];
	lst -&gt; evo	 [fontsize=10,
		pos=&quot;e,74.756,204.1 39.5,584.8 39.5,567 39.5,539.14 39.5,515 39.5,515 39.5,515 39.5,249 39.5,231.42 50.703,218.55 65.609,209.21&quot;];
	evo -&gt; htm	 [URL=&quot;../overview.html#gen-report&quot;,
		fontsize=10,
		label=&lt;&lt;B&gt;11. gen_report&lt;/B&gt;&gt;,
		labeltooltip=&quot;11. gen_report&quot;,
		lp=&quot;211,123&quot;,
		pos=&quot;e,219.77,62.2 143.33,167.81 147.69,150.37 156.13,123.96 170.5,105 181.52,90.459 196.91,77.758 211.39,67.765&quot;,
		target=_top];
	mri	 [fillcolor=&quot;#66CCEE&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;structural/mri/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;T1.mgz&lt;/FONT&gt;&gt;,
		pos=&quot;450.5,312&quot;,
		style=filled,
		width=1.0417];
	bem	 [fillcolor=&quot;#66CCEE&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;structural/bem/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*-bem-sol.fif&lt;/FONT&gt;&gt;,
		pos=&quot;537.5,249&quot;,
		style=filled,
		width=1.1111];
	mri -&gt; bem	 [fontsize=10,
		label=Freesurfer,
		labeltooltip=Freesurfer,
		lp=&quot;523,280.5&quot;,
		pos=&quot;e,512.39,267.18 475.66,293.78 484.59,287.31 494.78,279.94 504.28,273.06&quot;];
	tra	 [fillcolor=&quot;#EE6677&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/trans/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*-trans.fif&lt;/FONT&gt;&gt;,
		pos=&quot;355.5,249&quot;,
		style=filled,
		width=0.94444];
	mri -&gt; tra	 [fontsize=10,
		label=&quot;mne coreg&quot;,
		labeltooltip=&quot;mne coreg&quot;,
		lp=&quot;417.5,280.5&quot;,
		pos=&quot;e,370.41,267.02 412.82,297.99 405.47,294.55 398.03,290.53 391.5,286 386.6,282.59 381.81,278.45 377.4,274.19&quot;];
	src	 [fillcolor=&quot;#66CCEE&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;structural/bem/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*-src.fif&lt;/FONT&gt;&gt;,
		pos=&quot;443.5,249&quot;,
		style=filled,
		width=1.1111];
	mri -&gt; src	 [fontsize=10,
		pos=&quot;e,445.54,267.4 448.48,293.78 447.91,288.73 447.29,283.12 446.68,277.63&quot;];
	fwd	 [fillcolor=&quot;#66CCEE&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/forward/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*-fwd.fif&lt;/FONT&gt;&gt;,
		pos=&quot;358.5,186&quot;,
		style=filled,
		width=1.0972];
	bem -&gt; fwd	 [fontsize=10,
		pos=&quot;e,398.22,199.06 497.28,233.5 494.99,232.64 492.72,231.81 490.5,231 463.29,221.09 432.68,210.62 407.8,202.27&quot;];
	tra -&gt; fwd	 [URL=&quot;../overview.html#gen-fwd&quot;,
		fontsize=10,
		label=&lt;&lt;B&gt;9. gen_fwd&lt;/B&gt;&gt;,
		labeltooltip=&quot;9. gen_fwd&quot;,
		lp=&quot;387,217.5&quot;,
		pos=&quot;e,357.62,204.4 356.37,230.78 356.61,225.73 356.88,220.12 357.14,214.63&quot;,
		target=_top];
	src -&gt; fwd	 [fontsize=10,
		pos=&quot;e,398.31,198.39 435.14,230.75 431.4,224.17 426.49,217.1 420.5,212 416.55,208.63 412.1,205.65 407.44,203.02&quot;];
	inv	 [fillcolor=&quot;#66CCEE&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/inverse/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*-inv.fif&lt;/FONT&gt;&gt;,
		pos=&quot;313.5,123&quot;,
		style=filled,
		width=1.0833];
	fwd -&gt; inv	 [URL=&quot;../overview.html#gen-inv&quot;,
		fontsize=10,
		label=&lt;&lt;B&gt;10. gen_inv&lt;/B&gt;&gt;,
		labeltooltip=&quot;10. gen_inv&quot;,
		lp=&quot;370,154.5&quot;,
		pos=&quot;e,326.64,141.4 345.48,167.78 341.51,162.21 337.05,155.97 332.75,149.95&quot;,
		target=_top];
	inv -&gt; htm	 [fontsize=10,
		pos=&quot;e,266.57,62.223 299.35,104.68 291.5,94.507 281.59,81.678 272.91,70.438&quot;];
	pbd	 [fillcolor=&quot;#EE6677&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&quot;params.mf_prebad[SUBJ]&quot;,
		pos=&quot;236.5,735&quot;,
		style=filled,
		width=1.6806];
	mfb	 [fillcolor=&quot;#66CCEE&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/raw_fif/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*_raw_maxbad.txt&lt;/FONT&gt;&gt;,
		pos=&quot;170.5,647&quot;,
		style=filled,
		width=1.4583];
	pbd -&gt; mfb	 [URL=&quot;../overview.html#do-sss&quot;,
		fontsize=10,
		label=&lt;&lt;B&gt;3. do_sss&lt;/B&gt;&gt;,
		labeltooltip=&quot;3. do_sss&quot;,
		lp=&quot;208.5,691&quot;,
		pos=&quot;e,169.85,665.04 190.47,716.97 187.5,714.61 184.79,711.97 182.5,709 175.12,699.43 171.87,686.6 170.56,675.1&quot;,
		target=_top];
	mfp	 [fillcolor=&quot;#66CCEE&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/raw_fif/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*_raw.pos&lt;/FONT&gt;&gt;,
		pos=&quot;215.5,559&quot;,
		style=filled,
		width=1.0417];
	pbd -&gt; mfp	 [fontsize=10,
		pos=&quot;e,219.66,577.04 235.82,716.81 235.31,704.45 234.53,687.73 233.5,673 232.14,653.41 232.32,648.43 229.5,629 227.48,615.11 224.51,599.8 \
221.82,587.06&quot;];
	sss	 [fillcolor=&quot;#66CCEE&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/sss_fif/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*_raw_sss.fif&lt;/FONT&gt;&gt;,
		pos=&quot;267.5,418&quot;,
		style=filled,
		width=1.0694];
	pbd -&gt; sss	 [fontsize=10,
		pos=&quot;e,279.27,436.37 255.34,716.98 270.57,700.39 289.5,674.29 289.5,647 289.5,647 289.5,647 289.5,471 289.5,462.36 286.97,453.49 283.64,\
445.54&quot;];
	mfb -&gt; mfp	 [fontsize=10,
		pos=&quot;e,206.19,577.21 179.82,628.77 186.1,616.5 194.49,600.1 201.55,586.28&quot;];
	mfb -&gt; sss	 [fontsize=10,
		pos=&quot;e,228.99,425.01 161.95,628.82 145.91,591.72 116.28,506.35 155.5,453 163.39,442.27 192.45,433.36 218.99,427.22&quot;];
	mfp -&gt; sss	 [fontsize=10,
		pos=&quot;e,262.03,436.23 223.53,540.73 229.59,526.7 237.95,506.77 244.5,489 249.66,474.99 254.83,459.22 258.96,446.1&quot;];
	aan	 [fillcolor=&quot;#66CCEE&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/raw_fif/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*-annot.fif&lt;/FONT&gt;&gt;,
		pos=&quot;200.5,471&quot;,
		style=filled,
		width=1.0417];
	mfp -&gt; aan	 [fontsize=10,
		pos=&quot;e,203.6,489.21 212.39,540.77 210.34,528.73 207.61,512.72 205.29,499.08&quot;];
	sss -&gt; sss	 [URL=&quot;../overview.html#do-ch-fix&quot;,
		fontsize=10,
		label=&lt;&lt;B&gt;4. do_ch_fix&lt;/B&gt;&gt;,
		labeltooltip=&quot;4. do_ch_fix&quot;,
		lp=&quot;352.5,418&quot;,
		pos=&quot;e,306.19,413.3 306.19,422.7 314.22,422.21 320,420.64 320,418 320,416.68 318.56,415.63 316.11,414.84&quot;,
		target=_top];
	bad	 [fillcolor=&quot;#EE6677&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/bads/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*_post-sss.txt&lt;/FONT&gt;&gt;,
		pos=&quot;189.5,365&quot;,
		style=filled,
		width=1.1389];
	sss -&gt; bad	 [fontsize=10,
		pos=&quot;e,216.13,383.09 240.66,399.76 235.45,396.22 229.92,392.47 224.5,388.78&quot;];
	pca	 [fillcolor=&quot;#66CCEE&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/sss_pca_fif/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*_fil55_raw_sss.fif&lt;/FONT&gt;&gt;,
		pos=&quot;253.5,249&quot;,
		style=filled,
		width=1.4306];
	sss -&gt; pca	 [fontsize=10,
		pos=&quot;e,305.02,264.82 306.25,409.53 320.47,404.35 335.12,396.09 343.5,383 352.13,369.53 345.14,362.92 343.5,347 340.15,314.49 350.08,299.55 \
328.5,275 327.08,273.38 321.87,271 314.81,268.33&quot;];
	pro	 [fillcolor=&quot;#66CCEE&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/sss_pca_fif/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*-proj.fif&lt;/FONT&gt;&gt;,
		pos=&quot;252.5,312&quot;,
		style=filled,
		width=1.2778];
	sss -&gt; pro	 [URL=&quot;../overview.html#gen-ssp&quot;,
		fontsize=10,
		label=&lt;&lt;B&gt;5. gen_ssp&lt;/B&gt;&gt;,
		labeltooltip=&quot;5. gen_ssp&quot;,
		lp=&quot;112,365&quot;,
		pos=&quot;e,206.39,315.08 228.72,416.29 180.04,413.25 100.7,404.96 82.5,383 72.292,370.68 72.391,359.4 82.5,347 96.762,329.5 152.56,320.5 \
196.39,316.04&quot;,
		target=_top];
	pex	 [fillcolor=&quot;#FFD8DF&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/sss_pca_fif/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*-extra-proj.fif&lt;/FONT&gt;&gt;,
		pos=&quot;290.5,365&quot;,
		style=filled,
		width=1.2778];
	sss -&gt; pex	 [fontsize=10,
		pos=&quot;e,282.65,383.09 275.42,399.76 276.44,397.4 277.5,394.95 278.57,392.48&quot;];
	aan -&gt; sss	 [fontsize=10,
		pos=&quot;e,244.63,436.09 223.56,452.76 227.82,449.39 232.32,445.83 236.77,442.31&quot;];
	bad -&gt; pca	 [fontsize=10,
		pos=&quot;e,224.11,267.11 188.55,346.95 188.55,331.89 190.42,310.31 199.5,294 203.72,286.41 209.77,279.57 216.3,273.64&quot;];
	bad -&gt; pro	 [fontsize=10,
		pos=&quot;e,230.99,330.09 211.18,346.76 215.09,343.48 219.21,340 223.29,336.57&quot;];
	pca -&gt; evo	 [URL=&quot;../overview.html#write-epochs&quot;,
		fontsize=10,
		label=&lt;&lt;B&gt;7. write_epochs&lt;/B&gt;&gt;,
		labeltooltip=&quot;7. write_epochs&quot;,
		lp=&quot;209,217.5&quot;,
		pos=&quot;e,148.86,204.22 201.97,239.99 189.27,236.16 176.24,230.71 165.5,223 161.49,220.12 157.87,216.42 154.71,212.47&quot;,
		target=_top];
	pca -&gt; fwd	 [fontsize=10,
		pos=&quot;e,342.24,204.13 305.26,230.86 310.21,228.47 315.03,225.85 319.5,223 324.74,219.66 329.9,215.55 334.66,211.3&quot;];
	cov	 [fillcolor=&quot;#66CCEE&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/cov/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*-cov.fif&lt;/FONT&gt;&gt;,
		pos=&quot;256.5,186&quot;,
		style=filled,
		width=0.84722];
	pca -&gt; cov	 [URL=&quot;../overview.html#gen-covs&quot;,
		fontsize=10,
		label=&lt;&lt;B&gt;8. gen_covs&lt;/B&gt;&gt;,
		labeltooltip=&quot;8. gen_covs&quot;,
		lp=&quot;288,217.5&quot;,
		pos=&quot;e,255.62,204.4 254.37,230.78 254.61,225.73 254.88,220.12 255.14,214.63&quot;,
		target=_top];
	pro -&gt; pca	 [URL=&quot;../overview.html#apply-ssp&quot;,
		fontsize=10,
		label=&lt;&lt;B&gt;6. apply_ssp&lt;/B&gt;&gt;,
		labeltooltip=&quot;6. apply_ssp&quot;,
		lp=&quot;282.5,280.5&quot;,
		pos=&quot;e,249.56,267.12 249.08,293.94 248.54,289.61 248.17,284.91 248.62,277.39&quot;,
		target=_top];
	pex -&gt; pca	 [fontsize=10,
		pos=&quot;e,305.07,264.37 303.8,346.71 316,327.48 330.14,297.01 315.5,275 314.63,273.69 313.68,272.45 312.67,271.28&quot;];
	pex -&gt; pro	 [fontsize=10,
		pos=&quot;e,265.47,330.09 277.42,346.76 275.49,344.07 273.47,341.24 271.45,338.42&quot;];
	cov -&gt; htm	 [fontsize=10,
		pos=&quot;e,253.01,62.203 255.99,167.73 255.3,143.55 254.1,100.69 253.3,72.303&quot;];
	cov -&gt; inv	 [fontsize=10,
		pos=&quot;e,296.85,141.4 272.99,167.78 278.26,161.95 284.2,155.38 289.88,149.11&quot;];
	acq	 [fillcolor=&quot;#CCBB44&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;user&#64;minea&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*_raw.fif&lt;/FONT&gt;&gt;,
		pos=&quot;236.5,851&quot;,
		style=filled,
		width=0.94444];
	raw	 [fillcolor=&quot;#66CCEE&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/raw_fif/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*_raw.fif&lt;/FONT&gt;&gt;,
		pos=&quot;236.5,788&quot;,
		style=filled,
		width=1.0417];
	acq -&gt; raw	 [URL=&quot;../overview.html#fetch-raw&quot;,
		fontsize=10,
		label=&lt;&lt;B&gt;1. fetch_raw&lt;/B&gt;&gt;,
		labeltooltip=&quot;1. fetch_raw&quot;,
		lp=&quot;271,819.5&quot;,
		pos=&quot;e,236.5,806.4 236.5,832.78 236.5,827.73 236.5,822.12 236.5,816.63&quot;,
		target=_top];
	raw -&gt; sco	 [fontsize=10,
		pos=&quot;e,88.802,709.11 198.89,782.52 180.88,778.71 159.58,772.37 142.5,762 123.69,750.57 106.87,732.29 94.923,717.14&quot;];
	raw -&gt; pbd	 [fontsize=10,
		pos=&quot;e,236.5,753.09 236.5,769.76 236.5,767.66 236.5,765.47 236.5,763.27&quot;];
	raw -&gt; mfb	 [fontsize=10,
		pos=&quot;e,164.57,665.08 198.65,777.07 186.98,771.75 175.4,764.03 168.5,753 153.94,729.73 157.02,697.59 162.14,674.82&quot;];
	raw -&gt; sss	 [fontsize=10,
		pos=&quot;e,298.95,436.22 274.11,779.31 296.08,771.76 319.5,758.25 319.5,735 319.5,735 319.5,735 319.5,471 319.5,460.37 314.1,451.08 306.78,\
443.38&quot;];
	can	 [fillcolor=&quot;#FFD8DF&quot;,
		fontcolor=&quot;#000000&quot;,
		height=0.5,
		label=&lt;&lt;FONT POINT-SIZE=&quot;8&quot;&gt;./SUBJ/raw_fif/&lt;/FONT&gt;&lt;BR/&gt;&lt;FONT POINT-SIZE=&quot;10&quot;&gt;*-custom-annot.fif&lt;/FONT&gt;&gt;,
		pos=&quot;384.5,515&quot;,
		style=filled,
		width=1.4444];
	raw -&gt; can	 [fontsize=10,
		pos=&quot;e,378.51,533.32 274.1,780.29 312.5,771.31 366.5,755.11 366.5,735 366.5,735 366.5,735 366.5,603 366.5,582.73 371.14,560.35 375.71,\
543.23&quot;];
	can -&gt; sss	 [fontsize=10,
		pos=&quot;e,306.24,430.21 374.43,496.79 364.9,480.99 349.28,458.45 330.5,444 325.87,440.44 320.69,437.29 315.34,434.52&quot;];
}</p></object></div>
</div>
<div class="section" id="running-parameters">
<h2><a class="toc-backref" href="#id5">Running parameters</a><a class="headerlink" href="#running-parameters" title="Permalink to this headline">¶</a></h2>
<div class="section" id="general-general-options">
<h3><a class="toc-backref" href="#id6"><code class="docutils literal notranslate"><span class="pre">general</span></code>: General options</a><a class="headerlink" href="#general-general-options" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>work_dir<span class="classifier">str</span></dt><dd><p>Working directory, usually “.”.</p>
</dd>
<dt>subjects_dir<span class="classifier">str</span></dt><dd><p>Directory containing the structurals.</p>
</dd>
<dt>subject_indices<span class="classifier">list</span></dt><dd><p>Which subjects to process.</p>
</dd>
<dt>disp_files<span class="classifier">bool</span></dt><dd><p>Display status.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Anywhere a <code class="docutils literal notranslate"><span class="pre">dict</span></code> is supported as an option (e.g.,
<code class="docutils literal notranslate"><span class="pre">mf_prebad</span></code> or <code class="docutils literal notranslate"><span class="pre">proj_nums</span></code>), a special entry <code class="docutils literal notranslate"><span class="pre">'__default__'</span></code>
can be used turn the dictionary into a
<a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.defaultdict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">defaultdict</span></code></a> instance.
This is useful in cases where a single set of values works for most
subjects, but a few need different ones. For example in YAML form:</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">proj_nums</span><span class="p">:</span> <span class="p p-Indicator">{</span>
<span class="nt">  __default__</span><span class="p">:</span> <span class="p p-Indicator">[[</span><span class="nv">2</span><span class="p p-Indicator">,</span> <span class="nv">2</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">],</span> <span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">2</span><span class="p p-Indicator">],</span> <span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">]],</span>
<span class="nt">  subj_08</span><span class="p">:</span> <span class="p p-Indicator">[[</span><span class="nv">2</span><span class="p p-Indicator">,</span> <span class="nv">2</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">],</span> <span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">3</span><span class="p p-Indicator">],</span> <span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">]],</span>
  <span class="p p-Indicator">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="fetch-raw">
<h2><a class="toc-backref" href="#id7">1. fetch_raw</a><a class="headerlink" href="#fetch-raw" title="Permalink to this headline">¶</a></h2>
<p>Fetch raw files from an acquisition machine.</p>
<div class="section" id="fetch-raw-raw-fetching-parameters">
<h3><a class="toc-backref" href="#id8"><code class="docutils literal notranslate"><span class="pre">fetch_raw</span></code>: Raw fetching parameters</a><a class="headerlink" href="#fetch-raw-raw-fetching-parameters" title="Permalink to this headline">¶</a></h3>
<dl>
<dt>subjects<span class="classifier">list of str</span></dt><dd><p>Subject names.</p>
</dd>
<dt>structurals<span class="classifier">list of str</span></dt><dd><p>List of subject structurals.</p>
</dd>
<dt>dates<span class="classifier">list of tuple or None</span></dt><dd><p>Dates to use for anonymization. Use “None” to more fully anonymize.</p>
</dd>
<dt>acq_ssh<span class="classifier">str</span></dt><dd><p>The acquisition machine SSH name.</p>
</dd>
<dt>acq_dir<span class="classifier">list of str</span></dt><dd><p>List of paths to search and fetch raw data.</p>
</dd>
<dt>acq_port<span class="classifier">int</span></dt><dd><p>Acquisition port.</p>
</dd>
<dt>acq_exclude<span class="classifier">list of str</span></dt><dd><p>Regular expressions to exclude when trying to find the correct remote
directory. This can be useful for example if a subject was run more than
once, or someone has done some preprocessing or made copies on the
acquisition machine, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;genz_proc&#39;</span><span class="p">,</span> <span class="s1">&#39;genz_[0-9]+_[0-9]+a&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>which means “exclude anything with ‘genz_proc’; or anything with a
substring that has ‘genz_’, followed by at least one number, followed by
‘_’, followed by at least one number, followed by ‘a’” – the latter being
useful when subjects should be named <code class="docutils literal notranslate"><span class="pre">genz100_9a</span></code> but have some duplicate
directories named <code class="docutils literal notranslate"><span class="pre">genz_100_9a</span></code>.</p>
</dd>
<dt>run_names<span class="classifier">list of str</span></dt><dd><p>Run names for the paradigm.</p>
</dd>
<dt>runs_empty<span class="classifier">list of str</span></dt><dd><p>Empty room run names.</p>
</dd>
<dt>subject_run_indices<span class="classifier">list of array-like | dict | None</span></dt><dd><p>Run indices to include for each subject. This can be a list
(must be same length as <code class="docutils literal notranslate"><span class="pre">params.subjects</span></code>) or a dict (keys are subject
strings, values are the run indices) where missing subjects get all runs.
None is an alias for “all runs”.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="do-score">
<h2><a class="toc-backref" href="#id9">2. do_score</a><a class="headerlink" href="#do-score" title="Permalink to this headline">¶</a></h2>
<p>Do the scoring. This converts TTL triggers to meaningful events.</p>
<div class="section" id="scoring-scoring-parameters">
<h3><a class="toc-backref" href="#id10"><code class="docutils literal notranslate"><span class="pre">scoring</span></code>: Scoring parameters</a><a class="headerlink" href="#scoring-scoring-parameters" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>score<span class="classifier">callable | None</span></dt><dd><p>Scoring function used to slice data into trials.</p>
</dd>
<dt>on_process<span class="classifier">callable</span></dt><dd><p>Called at each processing step.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="do-sss">
<span id="id2"></span><h2><a class="toc-backref" href="#id11">3. do_sss</a><a class="headerlink" href="#do-sss" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Before running SSS, set <code class="docutils literal notranslate"><span class="pre">params.mf_prebad[SUBJ]</span></code> to a
list of bad MEG channels (str), or (old way) create
<em class="xref py py-obj">SUBJ/raw_fif/SUBJ_prebad.txt`</em> with space-separated list of bad
MEG channel numbers (int).
Using <code class="docutils literal notranslate"><span class="pre">p.mf_autobad=True</span></code> can help fill in missed bad channels,
but is not as reliable as experienced analyst inspection.</p>
</div>
<p>Run SSS processing. This will:</p>
<ol class="arabic simple">
<li><p>Copy each raw file to the SSS workstation.</p></li>
<li><p>Automatically determine bad channels (only if <code class="docutils literal notranslate"><span class="pre">mf_autobad=True</span></code>)</p></li>
<li><p>Estimate head positions (remotely if <code class="docutils literal notranslate"><span class="pre">hp_type='maxwell'</span></code>, otherwise
locally), see <a class="reference internal" href="#preprocessing-hpe"><span class="std std-ref">preprocessing: head_position_estimation: Head position estimation parameters</span></a>.</p></li>
<li><p>Copy the head positions to the local machine.</p></li>
<li><p>Delete generated files from the remote machine.</p></li>
<li><p>Annotate bad segments automatically, see <a class="reference internal" href="#preprocessing-annotations"><span class="std std-ref">preprocessing: annotations: Annotation parameters</span></a>.</p></li>
<li><p>Add any custom annotations (e.g., for segments that operators want to
manually mark as bad) that have been saved as <code class="docutils literal notranslate"><span class="pre">FILENAME-custom-annot.fif</span></code>.</p></li>
<li><p>Run SSS processing locally using <a class="reference external" href="https://mne.tools/dev/generated/mne.preprocessing.maxwell_filter.html#mne.preprocessing.maxwell_filter" title="(in MNE v0.23.dev0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.preprocessing.maxwell_filter()</span></code></a>.</p></li>
</ol>
<p>The addition of annotations <em>before</em> SSS ensures that tSSS operations are not
disrupted by bad segments of data, and also ensures that the output files
have the annotations (as they are preserved by <code class="docutils literal notranslate"><span class="pre">mnefun</span></code>).</p>
<div class="section" id="preprocessing-multithreading-multithreading-parameters">
<h3><a class="toc-backref" href="#id12"><code class="docutils literal notranslate"><span class="pre">preprocessing:</span> <span class="pre">multithreading</span></code>: Multithreading parameters</a><a class="headerlink" href="#preprocessing-multithreading-multithreading-parameters" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>n_jobs<span class="classifier">int</span></dt><dd><p>Number of jobs to use in parallel operations.</p>
</dd>
<dt>n_jobs_mkl<span class="classifier">int</span></dt><dd><p>Number of jobs to spawn in parallel for operations that can make
use of MKL threading. If Numpy/Scipy has been compiled with MKL
support, it is best to leave this at 1 or 2 since MKL will
automatically spawn threads. Otherwise, n_cpu is a good choice.</p>
</dd>
<dt>n_jobs_fir<span class="classifier">int | str</span></dt><dd><p>Number of threads to use for FIR filtering. Can also be ‘cuda’
if the system supports CUDA.</p>
</dd>
<dt>n_jobs_resample<span class="classifier">int | str</span></dt><dd><p>Number of threads to use for resampling. Can also be ‘cuda’
if the system supports CUDA.</p>
</dd>
</dl>
</div>
<div class="section" id="preprocessing-pre-sss-bads-automatic-bad-channel-detection">
<h3><a class="toc-backref" href="#id13"><code class="docutils literal notranslate"><span class="pre">preprocessing:</span> <span class="pre">pre-SSS</span> <span class="pre">bads</span></code>: Automatic bad channel detection</a><a class="headerlink" href="#preprocessing-pre-sss-bads-automatic-bad-channel-detection" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>mf_prebad<span class="classifier">dict</span></dt><dd><p>Dict with subject keys, with each value being a list of str of bad
MEG channels (e.g., <code class="docutils literal notranslate"><span class="pre">['MEG0121',</span> <span class="pre">'MEG1743']</span></code>).</p>
</dd>
<dt>mf_autobad<span class="classifier">bool</span></dt><dd><p>Default False. If True use Maxwell-filtering-based automatic bad
channel detection to mark bad channels <em>prior to SSS</em>.</p>
</dd>
<dt>mf_autobad_type<span class="classifier">str</span></dt><dd><p>Default ‘maxwell’. If ‘maxwell’, use MaxFilter to do automatic detection,
if ‘python’ (preferred) use MNE-Python.</p>
</dd>
<dt>mf_badlimit<span class="classifier">int</span></dt><dd><p>MaxFilter threshold for noisy channel detection (default is 7).</p>
</dd>
</dl>
</div>
<div class="section" id="preprocessing-head-position-estimation-head-position-estimation-parameters">
<span id="preprocessing-hpe"></span><h3><a class="toc-backref" href="#id14"><code class="docutils literal notranslate"><span class="pre">preprocessing:</span> <span class="pre">head_position_estimation</span></code>: Head position estimation parameters</a><a class="headerlink" href="#preprocessing-head-position-estimation-head-position-estimation-parameters" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>coil_t_window<span class="classifier">float | dict</span></dt><dd><p>Time window for coil position estimation.</p>
</dd>
<dt>coil_t_step_min<span class="classifier">float | dict</span></dt><dd><p>Coil step min for head / cHPI coil position estimation.</p>
</dd>
<dt>coil_dist_limit<span class="classifier">float | dict</span></dt><dd><p>Dist limit for coils.</p>
</dd>
<dt>coil_gof_limit<span class="classifier">float | dict</span></dt><dd><p>Goodness of fit limit for coils.</p>
</dd>
</dl>
</div>
<div class="section" id="preprocessing-annotations-annotation-parameters">
<span id="preprocessing-annotations"></span><h3><a class="toc-backref" href="#id15"><code class="docutils literal notranslate"><span class="pre">preprocessing:</span> <span class="pre">annotations</span></code>: Annotation parameters</a><a class="headerlink" href="#preprocessing-annotations-annotation-parameters" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>coil_bad_count_duration_limit<span class="classifier">float | dict</span></dt><dd><p>Remove segments with &lt; 3 good coils for at least this many sec.</p>
</dd>
<dt>rotation_limit<span class="classifier">float | dict</span></dt><dd><p>Rotation limit (deg/s) for annotating bad segments.</p>
</dd>
<dt>translation_limit<span class="classifier">float | dict</span></dt><dd><p>Head translation limit (m/s) for annotating bad segments.</p>
</dd>
</dl>
</div>
<div class="section" id="preprocessing-sss-sss-parameters">
<h3><a class="toc-backref" href="#id16"><code class="docutils literal notranslate"><span class="pre">preprocessing:</span> <span class="pre">sss</span></code>: SSS parameters</a><a class="headerlink" href="#preprocessing-sss-sss-parameters" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>movecomp<span class="classifier">str | None</span></dt><dd><p>Movement compensation to use. Can be ‘inter’ or None.</p>
</dd>
<dt>hp_type<span class="classifier">str</span></dt><dd><p>Head position estimation method. Must be either ‘maxfilter’ or ‘python’.</p>
</dd>
<dt>sss_type<span class="classifier">str</span></dt><dd><p>Signal space separation method. Must be either ‘maxfilter’ or ‘python’.</p>
</dd>
<dt>int_order<span class="classifier">int</span></dt><dd><p>Order of internal component of spherical expansion. Default is 8.
Value of 6 recomended for infant data.</p>
</dd>
<dt>ext_order<span class="classifier">int</span></dt><dd><p>Order of external component of spherical expansion. Default is 3.</p>
</dd>
<dt>sss_regularize<span class="classifier">str</span></dt><dd><p>SSS regularization, usually “in”.</p>
</dd>
<dt>tsss_dur<span class="classifier">float | None</span></dt><dd><p>Buffer length (in seconds) fpr Spatiotemporal SSS. Default is 60.
however based on system specification a shorter buffer may be
appropriate. For data containing excessive head movements e.g. young
children a buffer size of 4s is recommended.</p>
</dd>
<dt>st_correlation<span class="classifier">float</span></dt><dd><p>Correlation limit between inner and outer subspaces used to reject
ovwrlapping intersecting inner/outer signals during spatiotemporal SSS.
Default is .98 however a smaller value of .9 is recommended for infant/
child data.</p>
</dd>
<dt>filter_chpi<span class="classifier">str</span></dt><dd><p>Filter cHPI signals before SSS.</p>
</dd>
<dt>filter_chpi_t_window<span class="classifier">str | float | None</span></dt><dd><p>If None, use <code class="docutils literal notranslate"><span class="pre">coil_t_window</span></code>. Otherwise, options are the same as
<code class="docutils literal notranslate"><span class="pre">coil_t_window</span></code>.</p>
</dd>
<dt>trans_to<span class="classifier">str | array-like, (3,) | None</span></dt><dd><p>The destination location for the head. Can be:</p>
<ul class="simple">
<li><dl class="simple">
<dt>‘median’ (default)</dt><dd><p>Median (across runs) of the starting head positions.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>‘twa’</dt><dd><p>Time-weighted average head position.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">None</span></code></dt><dd><p>Will not change the head position.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>str</dt><dd><p>Path to a FIF file containing a MEG device to head transformation.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>array-like</dt><dd><p>First three elements are coordinates to translate to.
An optional fourth element gives the x-axis rotation (e.g., -30 means
a backward 30° rotation).</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>sss_origin<span class="classifier">array-like, shape (3,) | str</span></dt><dd><p>Origin of internal and external multipolar moment space in meters.
Default is center of sphere fit to digitized head points.</p>
</dd>
<dt>dig_with_eeg<span class="classifier">bool</span></dt><dd><p>If True, include EEG points in estimating the head origin.</p>
</dd>
<dt>ct_file<span class="classifier">str</span></dt><dd><p>Cross-talk file, usually “uw” to auto-load the UW file.</p>
</dd>
<dt>cal_file<span class="classifier">str</span></dt><dd><p>Calibration file, usually “uw” to auto-load the UW file.</p>
</dd>
<dt>sss_format<span class="classifier">str</span></dt><dd><p>Deprecated. SSS numerical format when using MaxFilter.</p>
</dd>
<dt>mf_args<span class="classifier">str</span></dt><dd><p>Deprecated. Extra arguments for MF SSS.</p>
</dd>
<dt>cont_as_esss<span class="classifier">bool</span></dt><dd><p>If True (default False), use eSSS to improve the external basis estimate
using continuous empty-room projectors (<code class="docutils literal notranslate"><span class="pre">proj_nums[2]</span></code>).
Only supported when Python is used for SSS.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="do-ch-fix">
<h2><a class="toc-backref" href="#id17">4. do_ch_fix</a><a class="headerlink" href="#do-ch-fix" title="Permalink to this headline">¶</a></h2>
<p>Fix EEG channel ordering, and also anonymize files.</p>
</div>
<div class="section" id="gen-ssp">
<h2><a class="toc-backref" href="#id18">5. gen_ssp</a><a class="headerlink" href="#gen-ssp" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Before running SSP, examine SSS’ed files and make
<code class="docutils literal notranslate"><span class="pre">SUBJ/bads/bad_ch_SUBJ_post-sss.txt</span></code>; usually, this should only
contain EEG channels. Alternatively, you can use
<code class="docutils literal notranslate"><span class="pre">params.auto_bad</span> <span class="pre">=</span> <span class="pre">some_float</span></code>, see
<a class="reference internal" href="#preprocessing-auto-bads"><span class="std std-ref">preprocessing: post-SSS bads: Marking bad channels during SSP</span></a>.</p>
</div>
<p>Generate SSP vectors. If additional projectors are required (e.g., to get
rid of muscle movement artifacts in a verbal response paradigm), you can use
<code class="docutils literal notranslate"><span class="pre">p.proj_extra</span></code>, which get applied before any other projectors are computed
(e.g., ECG, blink).</p>
<div class="section" id="preprocessing-filtering-filtering-parameters">
<h3><a class="toc-backref" href="#id19"><code class="docutils literal notranslate"><span class="pre">preprocessing:</span> <span class="pre">filtering</span></code>: Filtering parameters</a><a class="headerlink" href="#preprocessing-filtering-filtering-parameters" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>hp_cut<span class="classifier">float | None</span></dt><dd><p>Highpass cutoff in Hz. Use None for no highpassing.</p>
</dd>
<dt>hp_trans<span class="classifier">float</span></dt><dd><p>High-pass transition band.</p>
</dd>
<dt>lp_cut<span class="classifier">float</span></dt><dd><p>Cutoff for lowpass filtering.</p>
</dd>
<dt>lp_trans<span class="classifier">float</span></dt><dd><p>Low-pass transition band.</p>
</dd>
<dt>filter_length<span class="classifier">int | str</span></dt><dd><p>See <a class="reference external" href="https://mne.tools/dev/generated/mne.filter.create_filter.html#mne.filter.create_filter" title="(in MNE v0.23.dev0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.filter.create_filter()</span></code></a>.</p>
</dd>
<dt>fir_design<span class="classifier">str</span></dt><dd><p>See <a class="reference external" href="https://mne.tools/dev/generated/mne.filter.create_filter.html#mne.filter.create_filter" title="(in MNE v0.23.dev0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.filter.create_filter()</span></code></a>.</p>
</dd>
<dt>fir_window<span class="classifier">str</span></dt><dd><p>See <a class="reference external" href="https://mne.tools/dev/generated/mne.filter.create_filter.html#mne.filter.create_filter" title="(in MNE v0.23.dev0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.filter.create_filter()</span></code></a>.</p>
</dd>
<dt>phase<span class="classifier">str</span></dt><dd><p>See <a class="reference external" href="https://mne.tools/dev/generated/mne.filter.create_filter.html#mne.filter.create_filter" title="(in MNE v0.23.dev0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.filter.create_filter()</span></code></a>.</p>
</dd>
</dl>
</div>
<div class="section" id="preprocessing-post-sss-bads-marking-bad-channels-during-ssp">
<span id="preprocessing-auto-bads"></span><h3><a class="toc-backref" href="#id20"><code class="docutils literal notranslate"><span class="pre">preprocessing:</span> <span class="pre">post-SSS</span> <span class="pre">bads</span></code>: Marking bad channels during SSP</a><a class="headerlink" href="#preprocessing-post-sss-bads-marking-bad-channels-during-ssp" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>auto_bad<span class="classifier">float | None</span></dt><dd><p>If not None, bad channels will be automatically excluded after SSS if
they disqualify a proportion of events exceeding <code class="docutils literal notranslate"><span class="pre">auto_bad</span></code>.
This does not require the autoreject module.</p>
</dd>
<dt>auto_bad_reject<span class="classifier">str | dict | None</span></dt><dd><p>Default is None. Must be defined if using Autoreject module to
compute noisy sensor rejection criteria. Set to ‘auto’ to compute
criteria automatically, or dictionary of channel keys and amplitude
values e.g., dict(grad=1500e-13, mag=5000e-15, eeg=150e-6) to define
rejection threshold(s). See
<a class="reference external" href="http://autoreject.github.io/">http://autoreject.github.io/</a> for details.</p>
</dd>
<dt>auto_bad_flat<span class="classifier">dict | None</span></dt><dd><p>Flat threshold for auto bad.</p>
</dd>
<dt>auto_bad_eeg_thresh<span class="classifier">int | None</span></dt><dd><p>If more than this number of EEG channels is automatically marked bad,
an error will be raised. This helps ensure that not too many channels
are marked as bad.</p>
</dd>
<dt>auto_bad_meg_thresh<span class="classifier">int | None</span></dt><dd><p>Same as above but for MEG.</p>
</dd>
</dl>
</div>
<div class="section" id="preprocessing-ssp-ssp-creation-parameters">
<h3><a class="toc-backref" href="#id21"><code class="docutils literal notranslate"><span class="pre">preprocessing:</span> <span class="pre">ssp</span></code>: SSP creation parameters</a><a class="headerlink" href="#preprocessing-ssp-ssp-creation-parameters" title="Permalink to this headline">¶</a></h3>
<dl>
<dt>proj_nums<span class="classifier">list | dict</span></dt><dd><p>List of projector counts to use for ECG/blink/ERM/HEOG/VEOG; each list
contains three values for grad/mag/eeg channels.
Can be a dict that maps subject names to projector counts to use.
The order of computation and application is empty-room, ECG, blink,
HEOG, VEOG.</p>
<p>ECG, blink, and ERM are obligatory lists (though they can be lists of all
zeros). Lists for HEOG and VEOG are optional. For example,
if you want 1 blink, 2 HEOG, and 3 VEOG projectors (for a total of 6
EOG-related projectors) for each channel type, you would do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="o">...</span><span class="p">],</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
 <span class="p">[</span><span class="o">...</span><span class="p">],</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
 <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</pre></div>
</div>
<p>If you want just blink and HEOG, you can use a list of 4 lists instead of
5 (or 3).</p>
</dd>
<dt>proj_sfreq<span class="classifier">float | None</span></dt><dd><p>The sample freq to use for calculating projectors. Useful since
time points are not independent following low-pass. Also saves
computation to downsample.</p>
</dd>
<dt>proj_meg<span class="classifier">str</span></dt><dd><p>Can be “separate” (default for backward compat) or “combined”
(should be better for SSS’ed data).</p>
</dd>
<dt>drop_thresh<span class="classifier">float</span></dt><dd><p>The percentage threshold to use when deciding whether or not to
plot Epochs drop_log.</p>
</dd>
<dt>plot_raw<span class="classifier">bool</span></dt><dd><p>If True, plot the raw files with the ECG/EOG events overlaid.</p>
</dd>
<dt>ssp_eog_reject<span class="classifier">dict | None</span></dt><dd><p>Amplitude rejection criteria for EOG SSP computation. None will
use the mne-python default.</p>
</dd>
<dt>ssp_ecg_reject<span class="classifier">dict | None</span></dt><dd><p>Amplitude rejection criteria for ECG SSP computation. None will
use the mne-python default.</p>
</dd>
<dt>eog_channel<span class="classifier">str | dict | None</span></dt><dd><p>The channel to use to detect blink events. None will use EOG* channels.
In lieu of an EOG recording, MEG1411 may work.</p>
</dd>
<dt>heog_channel<span class="classifier">str | dict | None</span></dt><dd><p>The channel to use to detect HEOG events. None will use EOG061.
In lieu of an EOG recording, MEG1411 may work.</p>
</dd>
<dt>veog_channel<span class="classifier">str | dict | None</span></dt><dd><p>The channel to use to detect HEOG events. None will use EOG062.</p>
</dd>
<dt>ecg_channel<span class="classifier">str | dict | None</span></dt><dd><p>The channel to use to detect ECG events. None will use ECG063.
In lieu of an ECG recording, MEG1531 may work.
Can be a dict that maps subject names to channels.</p>
</dd>
<dt>eog_t_lims<span class="classifier">tuple | dict</span></dt><dd><p>The time limits for EOG calculation. Default (-0.25, 0.25).</p>
</dd>
<dt>heog_t_lims<span class="classifier">tuple | dict</span></dt><dd><p>The time limits for HEOG calculation. Default (-0.25, 0.25).</p>
</dd>
<dt>veog_t_lims<span class="classifier">tuple | dict</span></dt><dd><p>The time limits for VEOG calculation. Default (-0.25, 0.25).</p>
</dd>
<dt>ecg_t_lims<span class="classifier">tuple | dict</span></dt><dd><p>The time limits for ECG calculation. Default(-0.08, 0.08).</p>
</dd>
<dt>eog_f_lims<span class="classifier">tuple | dict</span></dt><dd><p>Band-pass limits for EOG detection and calculation. Default (0, 2).</p>
</dd>
<dt>heog_f_lims<span class="classifier">tuple | dict</span></dt><dd><p>Band-pass limits for HEOG detection and calculation. Default (0, 2).</p>
</dd>
<dt>veog_f_lims<span class="classifier">tuple | dict</span></dt><dd><p>Band-pass limits for VEOG detection and calculation. Default (0, 2).</p>
</dd>
<dt>ecg_f_lims<span class="classifier">tuple | dict</span></dt><dd><p>Band-pass limits for ECG detection and calculation. Default (5, 35).</p>
</dd>
<dt>eog_thresh<span class="classifier">float | dict | None</span></dt><dd><p>Threshold for EOG detection. Can vary per subject.</p>
</dd>
<dt>heog_thresh<span class="classifier">float | dict | None</span></dt><dd><p>Threshold for HEOG detection. Can vary per subject.</p>
</dd>
<dt>veog_thresh<span class="classifier">float | dict | None</span></dt><dd><p>Threshold for VEOG detection. Can vary per subject.</p>
</dd>
<dt>proj_ave<span class="classifier">bool</span></dt><dd><p>If True, average artifact epochs before computing proj.</p>
</dd>
<dt>proj_extra<span class="classifier">str | None</span></dt><dd><p>Extra projector filename to load for each subject, e.g.
<code class="docutils literal notranslate"><span class="pre">extra-proj.fif</span></code> will load <code class="docutils literal notranslate"><span class="pre">SUBJ/sss_pca_fif/extra-proj.fif</span></code>.</p>
</dd>
<dt>get_projs_from<span class="classifier">list of int | dict</span></dt><dd><p>Indices for runs to get projects from.</p>
</dd>
<dt>cont_hp<span class="classifier">float</span></dt><dd><p>Highpass to use for continuous ERM projectors (default None).</p>
</dd>
<dt>cont_hp_trans<span class="classifier">float | None</span></dt><dd><p>Highpass transition bandwidth to use for continuous ERM projectors
(default 0.5).</p>
</dd>
<dt>cont_lp<span class="classifier">float</span></dt><dd><p>Lowpass to use for continuous ERM projectors (default 5).</p>
</dd>
<dt>cont_lp_trans<span class="classifier">float | None</span></dt><dd><p>Lowpass transition bandwidth for continuous ERM projectors (default None).</p>
</dd>
<dt>cont_reject<span class="classifier">dict | None</span></dt><dd><p>Rejection parameters for continuous empty-room projection calculations.
None (default) will use <code class="docutils literal notranslate"><span class="pre">params.reject</span></code>.
This likely needs to be set when <code class="docutils literal notranslate"><span class="pre">cont_as_esss=True</span></code>.</p>
</dd>
<dt>plot_drop_logs<span class="classifier">bool</span></dt><dd><p>If True, plot drop logs after preprocessing.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="apply-ssp">
<h2><a class="toc-backref" href="#id22">6. apply_ssp</a><a class="headerlink" href="#apply-ssp" title="Permalink to this headline">¶</a></h2>
<p>Apply SSP vectors and filtering to the files.</p>
</div>
<div class="section" id="write-epochs">
<h2><a class="toc-backref" href="#id23">7. write_epochs</a><a class="headerlink" href="#write-epochs" title="Permalink to this headline">¶</a></h2>
<p>Write epochs to disk.</p>
<div class="section" id="epoching-epoching-parameters">
<h3><a class="toc-backref" href="#id24"><code class="docutils literal notranslate"><span class="pre">epoching</span></code>: Epoching parameters</a><a class="headerlink" href="#epoching-epoching-parameters" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>tmin<span class="classifier">float</span></dt><dd><p>tmin for events.</p>
</dd>
<dt>tmax<span class="classifier">float</span></dt><dd><p>tmax for events.</p>
</dd>
<dt>t_adjust<span class="classifier">float</span></dt><dd><p>Adjustment for delays (e.g., -4e-3 compensates for a 4 ms delay
in the trigger.</p>
</dd>
<dt>baseline<span class="classifier">tuple | None | str</span></dt><dd><p>Baseline to use. If “individual”, use <code class="docutils literal notranslate"><span class="pre">params.bmin</span></code> and
<code class="docutils literal notranslate"><span class="pre">params.bmax</span></code>, otherwise pass as the baseline parameter to
mne-python Epochs. <code class="docutils literal notranslate"><span class="pre">params.bmin</span></code> and <code class="docutils literal notranslate"><span class="pre">params.bmax</span></code> will always
be used for covariance calculation. This is useful e.g. when using
a high-pass filter and no baselining is desired (but evoked
covariances should still be calculated from the baseline period).</p>
</dd>
<dt>bmin<span class="classifier">float</span></dt><dd><p>Lower limit for baseline compensation.</p>
</dd>
<dt>bmax<span class="classifier">float</span></dt><dd><p>Upper limit for baseline compensation.</p>
</dd>
<dt>decim<span class="classifier">int | float | list</span></dt><dd><p>Amount to decimate the data after filtering when epoching data
(e.g., a factor of 5 on 1000 Hz data yields 200 Hz data).
If a float is used, it should be the destination sample rate
(e.g., a value of 200. with 1000 Hz data will use  decim=5).</p>
</dd>
<dt>epochs_type<span class="classifier">str | list</span></dt><dd><p>Can be ‘fif’, ‘mat’, or a list containing both.</p>
</dd>
<dt>match_fun<span class="classifier">callable | None</span></dt><dd><p>If None, standard matching will be performed. If a function,
must_match will be ignored, and <code class="docutils literal notranslate"><span class="pre">match_fun</span></code> will be called
to equalize event counts.</p>
</dd>
<dt>reject<span class="classifier">dict</span></dt><dd><p>Rejection parameters for epochs.</p>
</dd>
<dt>flat<span class="classifier">dict</span></dt><dd><p>Flat thresholds for epoch rejection.</p>
</dd>
<dt>reject_tmin<span class="classifier">float | None</span></dt><dd><p>Reject minimum time to use when epoching. None will use <code class="docutils literal notranslate"><span class="pre">tmin</span></code>.</p>
</dd>
<dt>reject_tmax<span class="classifier">float | None</span></dt><dd><p>Reject maximum time to use when epoching. None will use <code class="docutils literal notranslate"><span class="pre">tmax</span></code>.</p>
</dd>
<dt>on_missing<span class="classifier">string</span></dt><dd><p>Can set to ‘error’ | ‘warning’ | ‘ignore’. Default is ‘error’.
Determine what to do if one or several event ids are not found in the
recording during epoching. See mne.Epochs docstring for further
details.</p>
</dd>
<dt>autoreject_thresholds<span class="classifier">bool | False</span></dt><dd><p>If True use autoreject module to compute global rejection thresholds
for epoching. Make sure autoreject module is installed. See
<a class="reference external" href="http://autoreject.github.io/">http://autoreject.github.io/</a> for instructions.</p>
</dd>
<dt>autoreject_types<span class="classifier">tuple</span></dt><dd><p>Default is (‘mag’, ‘grad’, ‘eeg’). Can set to (‘mag’, ‘grad’, ‘eeg’,
‘eog) to use EOG channel rejection criterion from autoreject module to
reject trials on basis of EOG.</p>
</dd>
<dt>reject_epochs_by_annot<span class="classifier">bool | str</span></dt><dd><p>If True, reject epochs by BAD annotations. If str, will reject epochs by
annotations that match the given regular expression <code class="docutils literal notranslate"><span class="pre">str</span></code>.</p>
</dd>
<dt>pick_events_autoreject<span class="classifier">callable | string | None</span></dt><dd><p>Function for picking autoreject events, or the string “restrict”
to limit events to those with an id in <code class="docutils literal notranslate"><span class="pre">in_numbers</span></code>.</p>
</dd>
<dt>analyses<span class="classifier">list of str</span></dt><dd><p>Lists of analyses of interest.</p>
</dd>
<dt>in_names<span class="classifier">list of str</span></dt><dd><p>Names of input events.</p>
</dd>
<dt>in_numbers<span class="classifier">list of list of int</span></dt><dd><p>Event numbers (in scored event files) associated with each name.</p>
</dd>
<dt>out_names<span class="classifier">list of list of str</span></dt><dd><p>Event types to make out of old ones.</p>
</dd>
<dt>out_numbers<span class="classifier">list of list of int</span></dt><dd><p>Event numbers to convert to (e.g., [[1, 1, 2, 3, 3], …] would create
three event types, where the first two and last two event types from
the original list get collapsed over).</p>
</dd>
<dt>must_match<span class="classifier">list of int</span></dt><dd><p>Indices from the original in_names that must match in event counts
before collapsing. Should eventually be expanded to allow for
ratio-based collapsing.</p>
</dd>
<dt>every_other<span class="classifier">bool</span></dt><dd><p>If True, in addition to standard averages / evoked data, averages will be
computed from every other trial, i.e., from even and odd trials separately.
This can help assess the SNR of the data.</p>
</dd>
<dt>epochs_proj<span class="classifier">bool | ‘delayed’</span></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">proj</span></code> argument in <a class="reference external" href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="(in MNE v0.23.dev0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">mne.Epochs</span></code></a>. Should be <code class="docutils literal notranslate"><span class="pre">'delayed'</span></code> if
you want the option of plotting sensor-space data with no projectors.</p>
</dd>
<dt>allow_resample<span class="classifier">bool</span></dt><dd><p>If True (default False), allow resampling raw instances (and events) to
that of the first raw insntance in the case that raws do not all have a
matching sample rate. This is useful when recordings were errantly
performed at different sample rates.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="gen-covs">
<h2><a class="toc-backref" href="#id25">8. gen_covs</a><a class="headerlink" href="#gen-covs" title="Permalink to this headline">¶</a></h2>
<p>Generate covariances.</p>
<div class="section" id="covariance-covariance-parameters">
<h3><a class="toc-backref" href="#id26"><code class="docutils literal notranslate"><span class="pre">covariance</span></code>: Covariance parameters</a><a class="headerlink" href="#covariance-covariance-parameters" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>cov_method<span class="classifier">str</span></dt><dd><p>Covariance calculation method.</p>
</dd>
<dt>compute_rank<span class="classifier">bool</span></dt><dd><p>Default is False. Set to True to compute rank of the noise covariance
matrix during inverse kernel computation.</p>
</dd>
<dt>pick_events_cov<span class="classifier">callable | string | None</span></dt><dd><p>Function for picking covariance events, or the string “restrict”
to limit events to those with an id in <code class="docutils literal notranslate"><span class="pre">in_numbers</span></code>.</p>
</dd>
<dt>cov_rank<span class="classifier">str | int</span></dt><dd><p>Cov rank to use, usually “auto”.</p>
</dd>
<dt>cov_rank_method<span class="classifier">str</span></dt><dd><p>Can be “estimate_rank” to use <code class="docutils literal notranslate"><span class="pre">mne.rank.estimate_rank</span></code>, or
“compute_rank” to use <a class="reference external" href="https://mne.tools/dev/generated/mne.compute_rank.html#mne.compute_rank" title="(in MNE v0.23.dev0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.compute_rank()</span></code></a>. The latter seems to
work better for custom <code class="docutils literal notranslate"><span class="pre">tol</span></code> values by not row-normalizing data.</p>
</dd>
<dt>cov_rank_tol<span class="classifier">float | str</span></dt><dd><p>Tolerance for covariance rank computation. Can also be
“auto” or “float32”, though these tend not to be very robust.</p>
</dd>
<dt>force_erm_cov_rank_full<span class="classifier">bool</span></dt><dd><p>If True, force the ERM cov to be full rank.
Usually not needed, but might help when the empty-room data
is short and/or there are a lot of head movements.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="gen-fwd">
<h2><a class="toc-backref" href="#id27">9. gen_fwd</a><a class="headerlink" href="#gen-fwd" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make SUBJ/trans/SUBJ-trans.fif using <a class="reference external" href="https://mne.tools/dev/generated/commands.html#mne-coreg" title="(in MNE v0.23.dev0)"><span>mne coreg</span></a>.</p>
</div>
<p>Generate forward solutions (and source space if necessary).</p>
<div class="section" id="forward-forward-parameters">
<h3><a class="toc-backref" href="#id28"><code class="docutils literal notranslate"><span class="pre">forward</span></code>: Forward parameters</a><a class="headerlink" href="#forward-forward-parameters" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>bem_type<span class="classifier">str</span></dt><dd><p>Defaults to <code class="docutils literal notranslate"><span class="pre">'5120-5120-5120'</span></code>, use <code class="docutils literal notranslate"><span class="pre">'5120'</span></code> for a
single-layer BEM.</p>
</dd>
<dt>src<span class="classifier">str | dict</span></dt><dd><p>Can start be:</p>
<ul class="simple">
<li><p>‘oct6’ to use a surface source space decimated using the 6th
(or another integer) subdivision of an octahedron, or</p></li>
<li><p>‘vol5’ to use a volumetric grid source space with 5mm (or another
integer) spacing</p></li>
</ul>
</dd>
<dt>src_pos<span class="classifier">float</span></dt><dd><p>Default is 7 mm. Defines source grid spacing for volumetric source
space.</p>
</dd>
<dt>fwd_mindist<span class="classifier">float</span></dt><dd><p>Minimum distance (mm) for sources in the brain from the skull in order
for them to be included in the forward solution source space.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="gen-inv">
<h2><a class="toc-backref" href="#id29">10. gen_inv</a><a class="headerlink" href="#gen-inv" title="Permalink to this headline">¶</a></h2>
<p>Generate inverses.</p>
<div class="section" id="inverse-inverse-parameters">
<h3><a class="toc-backref" href="#id30"><code class="docutils literal notranslate"><span class="pre">inverse</span></code>: Inverse parameters</a><a class="headerlink" href="#inverse-inverse-parameters" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>inv_names<span class="classifier">list of str</span></dt><dd><p>Inverse names to use.</p>
</dd>
<dt>inv_runs<span class="classifier">list of int</span></dt><dd><p>Runs to use for each inverse.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="gen-report">
<h2><a class="toc-backref" href="#id31">11. gen_report</a><a class="headerlink" href="#gen-report" title="Permalink to this headline">¶</a></h2>
<p>Write <a class="reference external" href="https://mne.tools/dev/generated/mne.Report.html#mne.Report" title="(in MNE v0.23.dev0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">mne.Report</span></code></a> HTML of results to disk.</p>
<div class="section" id="report-params-report-parameters">
<h3><a class="toc-backref" href="#id32"><code class="docutils literal notranslate"><span class="pre">report_params</span></code>: Report parameters</a><a class="headerlink" href="#report-params-report-parameters" title="Permalink to this headline">¶</a></h3>
<dl>
<dt>pre_fun<span class="classifier">callable</span></dt><dd><p>Function to run before adding any Report sections. Must have the
signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pre_fun</span><span class="p">(</span><span class="n">report</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> is necessary for future compatibility.</p>
</dd>
<dt>chpi_snr<span class="classifier">bool</span></dt><dd><p>cHPI SNR (default True).</p>
</dd>
<dt>good_hpi_count<span class="classifier">bool</span></dt><dd><p>Number of good HPI coils (default True).</p>
</dd>
<dt>head_movement<span class="classifier">bool</span></dt><dd><p>Head movement (default True).</p>
</dd>
<dt>raw_segments<span class="classifier">bool</span></dt><dd><p>10 evenly spaced raw data segments (default True).</p>
</dd>
<dt>psd<span class="classifier">bool</span></dt><dd><p>Raw PSDs, often slow (default True).</p>
</dd>
<dt>ssp_topomaps<span class="classifier">bool</span></dt><dd><p>SSP topomaps (default True).</p>
</dd>
<dt>source_alignment<span class="classifier">bool</span></dt><dd><p>Source alignment (default True).</p>
</dd>
<dt>drop_log<span class="classifier">bool</span></dt><dd><p>Plot the epochs drop log (default True).</p>
</dd>
<dt>covariance<span class="classifier">bool</span></dt><dd><p>Covariance image and SVD plots.</p>
</dd>
<dt>bem<span class="classifier">bool</span></dt><dd><p>Plot the BEM.</p>
</dd>
<dt>snr<span class="classifier">dict</span></dt><dd><p>SNR plots, with keys ‘analysis’, ‘name’, and ‘inv’.</p>
</dd>
<dt>whitening<span class="classifier">dict</span></dt><dd><p>Whitening plots, with keys ‘analysis’, ‘name’, and ‘cov’.</p>
</dd>
<dt>sensor<span class="classifier">dict</span></dt><dd><p>Sensor topomaps, with keys ‘analysis’, ‘name’, ‘times’, and ‘proj’.
‘proj’ can be True (default), False, or ‘reconstruct’.
False and ‘reconstruct’ require <code class="docutils literal notranslate"><span class="pre">epochs_proj='delayed'</span></code>.</p>
</dd>
<dt>source<span class="classifier">dict</span></dt><dd><p>Source plots, with keys ‘analysis’, ‘name’, ‘inv’, ‘times’, ‘views’,
and ‘size’.</p>
</dd>
<dt>post_fun<span class="classifier">callable</span></dt><dd><p>Function to run after adding all other Report sections. Must have the same
signature as <code class="docutils literal notranslate"><span class="pre">pre_fun</span></code> above.</p>
</dd>
<dt>preload<span class="classifier">bool</span></dt><dd><p>If True (default False), load all raw data into memory before generating
plots. Can help speed up computations like PSD estimates, but can also
consume a large amount of memory.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="filename-standardization">
<h2><a class="toc-backref" href="#id33">Filename standardization</a><a class="headerlink" href="#filename-standardization" title="Permalink to this headline">¶</a></h2>
<p>mnefun imposes custom standardized structure on filenames:</p>
<div class="section" id="naming-file-naming-tags-and-folders">
<h3><a class="toc-backref" href="#id34"><code class="docutils literal notranslate"><span class="pre">naming</span></code>: File naming tags and folders</a><a class="headerlink" href="#naming-file-naming-tags-and-folders" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>list_dir<span class="classifier">str</span></dt><dd><p>Directory for event lists, usually “lists”.</p>
</dd>
<dt>bad_dir<span class="classifier">str</span></dt><dd><p>Directory to use for bad channels, usually “bads”.</p>
</dd>
<dt>bad_tag<span class="classifier">str</span></dt><dd><p>Tag for bid channel filename, usually “_post-sss.txt”.</p>
</dd>
<dt>raw_dir<span class="classifier">str</span></dt><dd><p>Raw directory, usually “raw_fif”.</p>
</dd>
<dt>keep_orig<span class="classifier">bool</span></dt><dd><p>Keep original files after anonymization.</p>
</dd>
<dt>raw_fif_tag<span class="classifier">str</span></dt><dd><p>File tag for raw data, usually “_raw.fif”.</p>
</dd>
<dt>sss_fif_tag<span class="classifier">str</span></dt><dd><p>File tag for SSS-processed files, usually “_raw_sss.fif”.</p>
</dd>
<dt>sss_dir<span class="classifier">str</span></dt><dd><p>Directory to use for SSS processed files, usually “sss_fif”.</p>
</dd>
<dt>pca_dir<span class="classifier">str</span></dt><dd><p>Directory for processed files, usually “sss_pca_fif”.</p>
</dd>
<dt>epochs_dir<span class="classifier">str</span></dt><dd><p>Directory for epochs, usually “epochs”.</p>
</dd>
<dt>epochs_prefix<span class="classifier">str</span></dt><dd><p>The prefix to use for the <code class="docutils literal notranslate"><span class="pre">-epo.fif</span></code> file.</p>
</dd>
<dt>epochs_tag<span class="classifier">str</span></dt><dd><p>Tag for epoochs, usually ‘-epo’.</p>
</dd>
<dt>eq_tag<span class="classifier">str</span></dt><dd><p>Tag for equalized data, usually “eq”.</p>
</dd>
<dt>cov_dir<span class="classifier">str</span></dt><dd><p>Directory to use for covariances, usually “covariance”.</p>
</dd>
<dt>forward_dir<span class="classifier">str</span></dt><dd><p>Directory for forward solutions, usually “forward”.</p>
</dd>
<dt>trans_dir<span class="classifier">str</span></dt><dd><p>Directory to use for trans files, usually “trans”.</p>
</dd>
<dt>inverse_dir<span class="classifier">str</span></dt><dd><p>Directory for storing inverses, usually “inverse”.</p>
</dd>
<dt>inv_tag<span class="classifier">str</span></dt><dd><p>Tag for all inverses, usually “-sss”.</p>
</dd>
<dt>inv_erm_tag<span class="classifier">str</span></dt><dd><p>Tag for ERM inverse, usually “-erm”.</p>
</dd>
<dt>inv_fixed_tag<span class="classifier">str</span></dt><dd><p>Tag for fixed inverse, usually “-fixed”.</p>
</dd>
<dt>inv_loose_tag<span class="classifier">str</span></dt><dd><p>Tag for loose inverse, usually “”.</p>
</dd>
<dt>inv_free_tag<span class="classifier">str</span></dt><dd><p>Tag for free orientation inverse, usually “-free”.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="preparing-your-machine-for-maxfilter-use">
<h2><a class="toc-backref" href="#id35">Preparing your machine for MaxFilter use</a><a class="headerlink" href="#preparing-your-machine-for-maxfilter-use" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Head position estimation and bad channel detection are now
available using <code class="docutils literal notranslate"><span class="pre">hp_type='python'</span></code> and
<code class="docutils literal notranslate"><span class="pre">mf_autobad_type='python</span></code>, respectively.
These are the preferred processing methods going forward
(as of March 2020), and using MaxFilter should be considered
deprecated.</p>
</div>
<p>Parameters for remotely connecting to SSS workstation (‘sws’) can be set
by adding a file <em class="xref py py-obj">json</em> with contents like:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkdir ~/.mnefun
<span class="gp">$ </span><span class="nb">echo</span> <span class="s1">&#39;{&quot;sws_ssh&quot;:&quot;kasga&quot;, &quot;sws_dir&quot;:&quot;/data06/larsoner/sss_work&quot;, &quot;sws_port&quot;:22}&#39;</span> &gt; ~/.mnefun/mnefun.json
</pre></div>
</div>
<p>This should be preferred to the old way, which was to set in each script
when running on your machine:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">params</span><span class="o">.</span><span class="n">sws_ssh</span> <span class="o">=</span> <span class="s1">&#39;kasga&#39;</span>
<span class="n">params</span><span class="o">.</span><span class="n">sws_dir</span> <span class="o">=</span> <span class="s1">&#39;/data06/larsoner/sss_work&#39;</span>
</pre></div>
</div>
<p>Using per-machine config files rather than per-script variables should
help increase portability of scripts without hurting reproducibility
(assuming we all use the same version of MaxFilter, which should be a
safe assumption).</p>
<p>To test that things are configured correctly, you can do:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python -c <span class="s2">&quot;import mnefun; mnefun.check_sws()&quot;</span>
<span class="go">On kasga: maxfilter -version (0 sec)</span>
<span class="go">Output:</span>
<span class="go">Revision: 2.2.15 Neuromag maxfilter Dec 11 2012 14:48:44</span>
</pre></div>
</div>
<p>If you get an error:</p>
<ol class="arabic">
<li><p>Ensure that your file is correctly set up in <code class="docutils literal notranslate"><span class="pre">~/.mnefun/mnefun.json</span></code>.
It needs to use standard quotation marks like <code class="docutils literal notranslate"><span class="pre">&quot;</span></code>, not fancy ones like
<code class="docutils literal notranslate"><span class="pre">”</span></code> so ensure that your text editor (if you used one) did not use fancy
quotation marks.</p></li>
<li><p>Ensure that <code class="docutils literal notranslate"><span class="pre">maxwell_filter</span></code> is accessible as a command on the remote
machine. Log into the remote machine and do:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>which maxfilter
<span class="go">/neuro/bin/util/maxfilter</span>
</pre></div>
</div>
<p>If you get no output with this command, it means that MaxFilter is not
available on your PATH on the remote machine. To fix this, consider adding
the following line to the end of your <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> on the remote machine:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span>:/neuro/bin/util:/neuro/bin/X11
</pre></div>
</div>
</li>
</ol>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2013-2021, mnefun Developers.<br/>
      Last updated on Apr 13, 2021.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>