

.. _sphx_glr_auto_examples_experiments_level_test.py:


============================================
Sound level test and visual size calibration
============================================

This example tests the audio level and video size. For audio, it produces an 80
db SPL 1000 Hz tone (note that at 1000 Hz, the frequency weighting for SPL
measurement shouldn't matter). For video, it produces a square that should be
10 degrees visual angle and tells you what the physical width should be in cm.
This of course depends on correct settings for monitor width, resolution, and
distance.




.. image:: /auto_examples/experiments/images/sphx_glr_level_test_001.png
    :align: center


.. rst-class:: sphx-glr-script-out

 Out::

    2017-06-30 16:54:00,882 - INFO    - Expyfun: Setting up Pyglet audio
    2017-06-30 16:54:00,930 - INFO    - Expyfun: Setting up screen
    2017-06-30 16:54:00,946 - EXP     - Expyfun: Set screen visibility True
    2017-06-30 16:54:00,988 - INFO    - Expyfun: Initializing dummy triggering mode
    2017-06-30 16:54:00,991 - INFO    - Expyfun: Initialization complete
    2017-06-30 16:54:00,991 - EXP     - Expyfun: Subject: s
    2017-06-30 16:54:00,992 - EXP     - Expyfun: Session: 0
    2017-06-30 16:54:01,013 - EXP     - Expyfun: Loading 488280 samples to buffer
    2017-06-30 16:54:01,126 - EXP     - Expyfun: Starting stimuli: flipping screen and playing audio
    2017-06-30 16:54:01,167 - EXP     - Expyfun: Audio stopped and reset.
    2017-06-30 16:54:01,168 - EXP     - Expyfun: Audio stopped and reset.




|


.. code-block:: python

    # Author: Ross Maddox <rkmaddox@uw.edu>
    #
    # License: BSD (3-clause)

    import numpy as np

    from expyfun import ExperimentController, building_doc
    from expyfun.visual import Rectangle
    import expyfun.analyze as ea

    print(__doc__)


    with ExperimentController('LevelTest', full_screen=True, noise_db=-np.inf,
                              participant='s', session='0', output_dir=None,
                              suppress_resamp=True, check_rms=None,
                              stim_db=80, version='dev') as ec:
        tone = (0.01 * np.sqrt(2.) *
                np.sin(2 * np.pi * 1000. * np.arange(0, 10, 1. / ec.fs)))
        assert np.allclose(np.sqrt(np.mean(tone * tone)), 0.01)
        square = Rectangle(ec, (0, 0, 10, 10), units='deg', fill_color='r')
        cm = np.diff(ec._convert_units([[0, 5], [0, 5]], 'deg', 'pix'),
                     axis=-1)[0] / ec.dpi / 0.39370
        ec.load_buffer(tone)  # RMS == 0.01
        pressed = None
        screenshot = None
        while pressed != '8':  # enable a clean quit if required
            square.draw()
            ec.screen_text('Width: {} cm'.format(np.round(2 * cm, 1)), wrap=False)
            ec.screen_text('Output level: {} dB'.format(ec.stim_db), wrap=True)
            screenshot = ec.screenshot() if screenshot is None else screenshot
            t1 = ec.start_stimulus(start_of_trial=False)  # skip checks
            pressed = ec.wait_one_press(10)[0] if not building_doc else '8'
            ec.flip()
            ec.wait_one_press(0.5 if not building_doc else 0.)
            ec.stop()

    ea.plot_screen(screenshot)

**Total running time of the script:** ( 0 minutes  0.448 seconds)



.. container:: sphx-glr-footer


  .. container:: sphx-glr-download

     :download:`Download Python source code: level_test.py <level_test.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: level_test.ipynb <level_test.ipynb>`

.. rst-class:: sphx-glr-signature

    `Generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
