

.. _sphx_glr_auto_examples_sync_sync_test.py:


=============
A-V sync test
=============

This example tests synchronization between the screen and the audio playback.

.. note: On Linux (w/NVIDIA), XFCE has been observed to give consistent
         timings, whereas Compiz WMs did not (doubled timings).




.. image:: /auto_examples/sync/images/sphx_glr_sync_test_001.png
    :align: center


.. rst-class:: sphx-glr-script-out

 Out::

    2017-08-16 16:22:19,461 - INFO    - Expyfun: Setting up Pyglet audio
    2017-08-16 16:22:19,507 - INFO    - Expyfun: Setting up screen
    2017-08-16 16:22:19,522 - EXP     - Expyfun: Set screen visibility True
    2017-08-16 16:22:19,574 - INFO    - Expyfun: Initializing dummy triggering mode
    2017-08-16 16:22:19,577 - INFO    - Expyfun: Initialization complete
    2017-08-16 16:22:19,577 - EXP     - Expyfun: Subject: s
    2017-08-16 16:22:19,578 - EXP     - Expyfun: Session: 0
    2017-08-16 16:22:19,595 - EXP     - Expyfun: Loading 200 samples to buffer
    2017-08-16 16:22:19,622 - EXP     - Expyfun: Starting stimuli: flipping screen and playing audio
    2017-08-16 16:22:19,888 - EXP     - Expyfun: Audio stopped and reset.
    2017-08-16 16:22:19,890 - EXP     - Expyfun: Audio stopped and reset.




|


.. code-block:: python

    # Author: Dan McCloy <drmccloy@uw.edu>
    #
    # License: BSD (3-clause)

    import numpy as np

    from expyfun import ExperimentController, building_doc
    from expyfun.visual import Circle
    import expyfun.analyze as ea

    print(__doc__)


    # Fullscreen MUST be used to guarantee flip accuracy!
    with ExperimentController('SyncTest', full_screen=True, noise_db=-np.inf,
                              participant='s', session='0', output_dir=None,
                              suppress_resamp=True, check_rms=None,
                              version='dev') as ec:
        ec.load_buffer(np.r_[0.1, np.zeros(99)])  # RMS == 0.01
        pressed = None
        screenshot = None
        # Make a circle so that the photodiode can be centered on the screen
        circle = Circle(ec, 1, units='deg', fill_color='k', line_color='w')
        while pressed != '8':  # enable a clean quit if required
            ec.set_background_color('white')
            t1 = ec.start_stimulus(start_of_trial=False)  # skip checks
            ec.set_background_color('black')
            t2 = ec.flip()
            diff = round(1000 * (t2 - t1), 2)
            ec.screen_text('IFI (ms): {}'.format(diff), wrap=True)
            circle.draw()
            screenshot = ec.screenshot() if screenshot is None else screenshot
            ec.flip()
            ec.stamp_triggers([2, 4, 8])
            pressed = ec.wait_one_press(0.5)[0] if not building_doc else '8'
            ec.stop()

    ea.plot_screen(screenshot)

**Total running time of the script:** ( 0 minutes  0.569 seconds)



.. container:: sphx-glr-footer


  .. container:: sphx-glr-download

     :download:`Download Python source code: sync_test.py <sync_test.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: sync_test.ipynb <sync_test.ipynb>`

.. rst-class:: sphx-glr-signature

    `Generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
