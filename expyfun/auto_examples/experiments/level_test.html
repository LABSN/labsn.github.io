<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Sound level test and visual size calibration &mdash; Expyfun 2.0.0.dev0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/navy.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.0.0.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Expyfun 2.0.0.dev0 documentation" href="../../index.html" />
    <link rel="up" title="Examples" href="../index.html" />
    <link rel="next" title="Version checking functions" href="version_checking.html" />
    <link rel="prev" title="A-V sync test" href="sync_test.html" />
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
 

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../np-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="version_checking.html" title="Version checking functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sync_test.html" title="A-V sync test"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Expyfun 2.0.0.dev0 documentation</a> &raquo;</li>
          <li><a href="../../expyfun.html" >Expyfun</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Examples</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="sound-level-test-and-visual-size-calibration">
<span id="example-experiments-level-test-py"></span><h1>Sound level test and visual size calibration<a class="headerlink" href="#sound-level-test-and-visual-size-calibration" title="Permalink to this headline">Â¶</a></h1>
<p>This example tests the audio level and video size. For audio, it produces a 65
db SPL 1000 Hz tone (note that at 1000 Hz, the frequency weighting for SPL
measurement shouldn&#8217;t matter). For video, it produces a square that should be
10 degrees visual angle and tells you what the physical width should be in cm.
This of course depends on correct settings for monitor width, resolution, and
distance.</p>
<img alt="../../_images/level_test_001.png" class="align-center" src="../../_images/level_test_001.png" />
<p><strong>Script output</strong>:</p>
<div class="highlight-python"><div class="highlight"><pre>2015-05-18 11:20:39,764 - INFO  - Expyfun: Setting up Pyglet audio
2015-05-18 11:20:39,808 - INFO  - Expyfun: Setting up screen
2015-05-18 11:20:40,023 - EXP   - Expyfun: Set screen visibility True
2015-05-18 11:20:40,072 - INFO  - Expyfun: Initializing dummy triggering mode
2015-05-18 11:20:40,076 - INFO  - Expyfun: Initialization complete
2015-05-18 11:20:40,076 - EXP   - Expyfun: Subject: s
2015-05-18 11:20:40,077 - EXP   - Expyfun: Session: 0
2015-05-18 11:20:40,092 - EXP   - Expyfun: Loading 488282 samples to buffer
2015-05-18 11:20:40,157 - EXP   - Expyfun: Starting stimuli: flipping screen and playing audio
2015-05-18 11:20:40,790 - EXP   - Expyfun: Audio stopped and reset.
2015-05-18 11:20:40,813 - EXP   - Expyfun: Audio stopped and reset.
</pre></div>
</div>
<p><strong>Python source code:</strong> <a class="reference download internal" href="../../_downloads/level_test.py"><tt class="xref download docutils literal"><span class="pre">level_test.py</span></tt></a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Author: Ross Maddox &lt;rkmaddox@uw.edu&gt;</span>
<span class="c">#</span>
<span class="c"># License: BSD (3-clause)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">expyfun</span> <span class="kn">import</span> <a href="../../generated/expyfun.ExperimentController.html#expyfun.ExperimentController"><span class="n">ExperimentController</span></a>
<span class="kn">from</span> <span class="nn">expyfun.visual</span> <span class="kn">import</span> <a href="../../generated/expyfun.visual.Rectangle.html#expyfun.visual.Rectangle"><span class="n">Rectangle</span></a>
<span class="kn">import</span> <span class="nn">expyfun.analyze</span> <span class="kn">as</span> <span class="nn">ea</span>

<span class="k">print</span><span class="p">(</span><span class="n">__doc__</span><span class="p">)</span>


<span class="k">with</span> <a href="../../generated/expyfun.ExperimentController.html#expyfun.ExperimentController"><span class="n">ExperimentController</span></a><span class="p">(</span><span class="s">&#39;LevelTest&#39;</span><span class="p">,</span> <span class="n">full_screen</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">noise_db</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>
                          <span class="n">participant</span><span class="o">=</span><span class="s">&#39;s&#39;</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="s">&#39;0&#39;</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">suppress_resamp</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">check_rms</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">stim_db</span><span class="o">=</span><span class="mi">65</span><span class="p">)</span> <span class="k">as</span> <span class="n">ec</span><span class="p">:</span>
    <span class="n">tone</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.01</span> <span class="o">*</span> <a href="http://docs.scipy.org/doc/numpy-1.6.0/reference/generated/numpy.sqrt.html#numpy.sqrt"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><span class="mf">2.</span><span class="p">)</span> <span class="o">*</span>
            <a href="http://docs.scipy.org/doc/numpy-1.6.0/reference/generated/numpy.sin.html#numpy.sin"><span class="n">np</span><span class="o">.</span><span class="n">sin</span></a><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1000.</span> <span class="o">*</span> <a href="http://docs.scipy.org/doc/numpy-1.6.0/reference/generated/numpy.arange.html#numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">ec</span><span class="o">.</span><span class="n">fs</span><span class="p">)))</span>
    <span class="k">assert</span> <a href="http://docs.scipy.org/doc/numpy-1.6.0/reference/generated/numpy.allclose.html#numpy.allclose"><span class="n">np</span><span class="o">.</span><span class="n">allclose</span></a><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.6.0/reference/generated/numpy.sqrt.html#numpy.sqrt"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.6.0/reference/generated/numpy.mean.html#numpy.mean"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">tone</span> <span class="o">*</span> <span class="n">tone</span><span class="p">)),</span> <span class="mf">0.01</span><span class="p">)</span>
    <span class="n">square</span> <span class="o">=</span> <a href="../../generated/expyfun.visual.Rectangle.html#expyfun.visual.Rectangle"><span class="n">Rectangle</span></a><span class="p">(</span><span class="n">ec</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s">&#39;deg&#39;</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">cm</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.6.0/reference/generated/numpy.diff.html#numpy.diff"><span class="n">np</span><span class="o">.</span><span class="n">diff</span></a><span class="p">(</span><span class="n">ec</span><span class="o">.</span><span class="n">_convert_units</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span> <span class="s">&#39;deg&#39;</span><span class="p">,</span> <span class="s">&#39;pix&#39;</span><span class="p">),</span>
                 <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">ec</span><span class="o">.</span><span class="n">dpi</span> <span class="o">/</span> <span class="mf">0.39370</span>
    <span class="n">ec</span><span class="o">.</span><span class="n">load_buffer</span><span class="p">(</span><span class="n">tone</span><span class="p">)</span>  <span class="c"># RMS == 0.01</span>
    <span class="n">pressed</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">screenshot</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">while</span> <span class="n">pressed</span> <span class="o">!=</span> <span class="s">&#39;8&#39;</span><span class="p">:</span>  <span class="c"># enable a clean quit if required</span>
        <span class="n">square</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="n">ec</span><span class="o">.</span><span class="n">screen_text</span><span class="p">(</span><span class="s">&#39;Width: {} cm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">cm</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">wrap</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">screenshot</span> <span class="o">=</span> <span class="n">ec</span><span class="o">.</span><span class="n">screenshot</span><span class="p">()</span> <span class="k">if</span> <span class="n">screenshot</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">screenshot</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">ec</span><span class="o">.</span><span class="n">start_stimulus</span><span class="p">(</span><span class="n">start_of_trial</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>  <span class="c"># skip checks</span>
        <span class="n">pressed</span> <span class="o">=</span> <span class="n">ec</span><span class="o">.</span><span class="n">wait_one_press</span><span class="p">(</span><span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ec</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
        <span class="n">ec</span><span class="o">.</span><span class="n">wait_one_press</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ec</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.ion"><span class="n">plt</span><span class="o">.</span><span class="n">ion</span></a><span class="p">()</span>
<span class="n">ea</span><span class="o">.</span><span class="n">plot_screen</span><span class="p">(</span><span class="n">screenshot</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Total running time of the example:</strong>    1 seconds</p>
<div class="social-button-container">
    <div class="social-button">
        <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
    </div>
    <div class="social-button">
        <g:plusone annotation="inline" width="120" size="medium"></g:plusone>
    </div>
    <div class="social-button">
        <div id="fb-root"></div>
        <script>(function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
            fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));
        </script>
        <div class="fb-like" data-send="false" data-width="450" data-show-faces="false"></div>
    </div>
</div></div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
        &copy; Copyright 2013-2015, Expyfun Developers.
      Last updated on May 18, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>